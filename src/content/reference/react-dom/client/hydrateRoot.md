---
title: hydrateRoot
translators:
  - childrentime
---

<Intro>

`hydrateRoot` å‡½æ•°å…è®¸ä½ åœ¨å…ˆå‰ç”± [`react-dom/server`](/reference/react-dom/server) ç”Ÿæˆçš„æµè§ˆå™¨ HTML DOM èŠ‚ç‚¹ä¸­å±•ç¤º React ç»„ä»¶ã€‚

```js
const root = hydrateRoot(domNode, reactNode, options?)
```

</Intro>

<InlineToc />

---

## å‚è€ƒ {/*reference*/}

### `hydrateRoot(domNode, reactNode, options?)` {/*hydrateroot*/}

ç”¨ `hydrateRoot` å‡½æ•°å°† React è¿æ¥åˆ°ç”± React åœ¨æœåŠ¡ç«¯ç¯å¢ƒä¸­æ¸²æŸ“çš„ç°æœ‰ HTML ä¸­ã€‚

```js
import { hydrateRoot } from 'react-dom/client';

const domNode = document.getElementById('root');
const root = hydrateRoot(domNode, reactNode);
```

React å°†ä¼šè¿æ¥åˆ°å†…éƒ¨æœ‰ `domNode` çš„ HTML ä¸Šï¼Œç„¶åæ¥ç®¡å…¶ä¸­çš„ `domNode`ã€‚ä¸€ä¸ªå®Œå…¨ç”± React æ„å»ºçš„åº”ç”¨åªä¼šåœ¨å…¶æ ¹ç»„ä»¶ä¸­è°ƒç”¨ä¸€æ¬¡ `hydrateRoot` æ–¹æ³•ã€‚

[è¯·å‚è§ä¸‹é¢æ›´å¤šç¤ºä¾‹](#usage)ã€‚

#### å‚æ•° {/*parameters*/}

* `domNode`ï¼šä¸€ä¸ªåœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“æ—¶å‘ˆç°ä¸ºæ ¹å…ƒç´ çš„ [DOM å…ƒç´ ](https://developer.mozilla.org/zh-CN/docs/Web/API/Element)ã€‚

* `reactNode`ï¼šç”¨äºæ¸²æŸ“å·²å­˜åœ¨ HTML çš„â€œReact èŠ‚ç‚¹â€ã€‚è¿™ä¸ªèŠ‚ç‚¹é€šå¸¸æ˜¯ä¸€äº›ç±»ä¼¼äº `<App />` çš„ JSXï¼Œå®ƒä¼šåœ¨ `ReactDOM Server` ç«¯ä½¿ç”¨ç±»ä¼¼äº `renderToPipeableStream(<App />)` çš„æ–¹æ³•è¿›è¡Œæ¸²æŸ“ã€‚

* **å¯é€‰**  `options`ï¼šä¸€ä¸ªåŒ…å«æ­¤ React æ ¹å…ƒç´ é€‰é¡¹çš„å¯¹è±¡ã€‚

  * **optional** `onCaughtError`: Callback called when React catches an error in an Error Boundary. Called with the `error` caught by the Error Boundary, and an `errorInfo` object containing the `componentStack`.
  * **optional** `onUncaughtError`: Callback called when an error is thrown and not caught by an Error Boundary. Called with the `error` that was thrown and an `errorInfo` object containing the `componentStack`.
  * **optional** `onRecoverableError`: Callback called when React automatically recovers from errors. Called with the `error` React throws, and an `errorInfo` object containing the `componentStack`. Some recoverable errors may include the original error cause as `error.cause`.
  * **optional** `identifierPrefix`: A string prefix React uses for IDs generated by [`useId`.](/reference/react/useId) Useful to avoid conflicts when using multiple roots on the same page. Must be the same prefix as used on the server.


#### è¿”å›å€¼ {/*returns*/}

`hydrateRoot` è¿”å›ä¸€ä¸ªåŒ…å«ä¸¤ä¸ªæ–¹æ³•çš„å¯¹è±¡ [`render`](#root-render) å’Œ [`unmount`](#root-unmount)ã€‚

#### è­¦å‘Š {/*caveats*/}

* `hydrateRoot()` æœŸæœ›æ¸²æŸ“å†…å®¹ä¸æœåŠ¡ç«¯æ¸²æŸ“çš„å†…å®¹å®Œå…¨ç›¸åŒã€‚ä½ åº”è¯¥å°†ä¸åŒ¹é…è§†ä¸ºé”™è¯¯å¹¶è¿›è¡Œä¿®å¤ã€‚
* åœ¨å¼€å‘æ¨¡å¼ä¸‹ï¼ŒReact ä¼šåœ¨æ¿€æ´»æœŸé—´å‘å‡ºä¸åŒ¹é…è­¦å‘Šã€‚åœ¨ä¸åŒ¹é…çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½ä¿è¯å†…å®¹å·®å¼‚ä¼šè¢«ä¿®è¡¥ã€‚å‡ºäºæ€§èƒ½åŸå› ï¼Œè¿™å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨å¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸­ï¼Œä¸åŒ¹é…å¾ˆå°‘è§ï¼Œå› æ­¤éªŒè¯æ‰€æœ‰æ ‡è®°å°†æ˜¯æ˜‚è´µè€Œä¸å¯è¡Œçš„ã€‚
* ä½ çš„åº”ç”¨ç¨‹åºå¯èƒ½åªæœ‰ä¸€ä¸ª `hydrateRoot()` å‡½æ•°è°ƒç”¨ã€‚å¦‚æœä½ ä½¿ç”¨æ¡†æ¶ï¼Œåˆ™å¯èƒ½ä¼šä¸ºä½ å®Œæˆæ­¤è°ƒç”¨ã€‚
* å¦‚æœä½ çš„åº”ç”¨ç¨‹åºæ˜¯å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œå¹¶ä¸”æ²¡æœ‰å·²æ¸²æŸ“å¥½çš„ HTMLï¼Œåˆ™ä¸æ”¯æŒä½¿ç”¨ `hydrateRoot()`ã€‚è¯·æ”¹ç”¨ [`createRoot()`](/reference/react-dom/client/createRoot)ã€‚

---

### `root.render(reactNode)` {/*root-render*/}

ä½¿ç”¨ `root.render` æ›´æ–°ä¸€ä¸ªæ¿€æ´»æ ¹ç»„ä»¶ä¸­çš„ React ç»„ä»¶æ¥æ¸²æŸ“æµè§ˆå™¨ç«¯ DOM å…ƒç´ ã€‚

```js
root.render(<App />);
```

React å°†ä¼šåœ¨æ¿€æ´» `root` ä¸­æ›´æ–° `<App />`ã€‚

[å‚è§ä¸‹é¢æ›´å¤šç¤ºä¾‹](#usage)ã€‚

#### å‚æ•° {/*root-render-parameters*/}

* `reactNode`ï¼šä½ æƒ³è¦æ›´æ–°çš„ "React èŠ‚ç‚¹"ã€‚é€šå¸¸è¿™ä¼šæ˜¯ä¸€æ®µJSXä»£ç ï¼Œä¾‹å¦‚ `<App />`ï¼Œä½†ä½ ä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªé€šè¿‡ [`createElement()`](/reference/react/createElement) åˆ›å»ºçš„ React å…ƒç´ ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¸€ä¸ªæ•°å­—ï¼Œ`null` å€¼ æˆ–è€… `undefined` å€¼ã€‚


#### è¿”å›å€¼ {/*root-render-returns*/}

`root.render` è¿”å› `undefined` å€¼ã€‚

#### è­¦å‘Š {/*root-render-caveats*/}

* å¦‚æœä½ åœ¨æ ¹èŠ‚ç‚¹è¿˜æ²¡æœ‰å®Œæˆæ¿€æ´»çš„æƒ…å†µä¸‹è°ƒç”¨äº† `root.render`ï¼ŒReact å°†æ¸…é™¤ç°æœ‰çš„æœåŠ¡ç«¯æ¸²æŸ“ HTML å†…å®¹ï¼Œå¹¶å°†æ•´ä¸ªæ ¹èŠ‚ç‚¹åˆ‡æ¢åˆ°å®¢æˆ·ç«¯æ¸²æŸ“ã€‚

---

### `root.unmount()` {/*root-unmount*/}

è°ƒç”¨ `root.unmount` æ¥é”€æ¯ React æ ¹èŠ‚ç‚¹å†…çš„æ¸²æŸ“æ ‘ã€‚

```js
root.unmount();
```

å®Œå…¨ä½¿ç”¨ React æ„å»ºçš„åº”ç”¨é€šå¸¸ä¸ä¼šæœ‰ä»»ä½•è°ƒç”¨ `root.unmount` çš„æƒ…å†µã€‚

è¿™ä¸»è¦é€‚ç”¨äº React æ ¹èŠ‚ç‚¹çš„ DOM èŠ‚ç‚¹ï¼ˆæˆ–å…¶ä»»ä½•ç¥–å…ˆèŠ‚ç‚¹ï¼‰å¯èƒ½ä¼šè¢«å…¶ä»–ä»£ç ä» DOM ä¸­ç§»é™¤çš„æƒ…å†µã€‚ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ä¸€ä¸ª jQuery æ ‡ç­¾é¢æ¿ï¼Œå®ƒä¼šå°†éæ´»åŠ¨æ ‡ç­¾ä» DOM ä¸­ç§»é™¤ã€‚å¦‚æœä¸€ä¸ªæ ‡ç­¾è¢«ç§»é™¤ï¼Œå…¶å†…éƒ¨çš„æ‰€æœ‰å†…å®¹ï¼ˆåŒ…æ‹¬å…¶ä¸­çš„ React æ ¹èŠ‚ç‚¹ï¼‰ä¹Ÿå°†ä» DOM ä¸­ç§»é™¤ã€‚ä½ éœ€è¦è°ƒç”¨ `root.unmount` æ¥å‘Šè¯‰ React â€œåœæ­¢â€ç®¡ç†å·²ç§»é™¤æ ¹èŠ‚ç‚¹çš„å†…å®¹ã€‚å¦åˆ™ï¼Œå·²ç§»é™¤æ ¹èŠ‚ç‚¹å†…çš„ç»„ä»¶å°†æ— æ³•æ¸…ç†å’Œé‡Šæ”¾å·²ä½¿ç”¨çš„èµ„æºï¼Œä¾‹å¦‚è®¢é˜…ã€‚

è°ƒç”¨ `root.unmount` å°†å¸è½½æ ¹èŠ‚ç‚¹ä¸­çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶â€œåˆ†ç¦»â€ React ä¸æ ¹ DOM èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼ŒåŒ…æ‹¬åˆ é™¤æ ‘ä¸­çš„ä»»ä½•äº‹ä»¶å¤„ç†ç¨‹åºæˆ–çŠ¶æ€ã€‚


#### å‚æ•° {/*root-unmount-parameters*/}


`root.unmount` ä¸æ¥å—ä»»ä½•å‚æ•°ã€‚

#### è¿”å›å€¼ {/*root-unmount-returns*/}

`render` è¿”å› `undefined` å€¼ã€‚

#### è­¦å‘Š {/*root-unmount-caveats*/}

* è°ƒç”¨ `root.unmount` å°†å¸è½½æ ‘ä¸­çš„æ‰€æœ‰ç»„ä»¶ï¼Œå¹¶â€œåˆ†ç¦»â€ React ä¸æ ¹ DOM èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ã€‚

* ä¸€æ—¦ä½ è°ƒç”¨ `root.unmount`ï¼Œå°±ä¸èƒ½å†åœ¨æ ¹èŠ‚ç‚¹ä¸Šè°ƒç”¨ `root.render`ã€‚åœ¨æœªæŒ‚è½½çš„æ ¹èŠ‚ç‚¹ä¸Šå°è¯•è°ƒç”¨ `root.render` å°†æŠ›å‡ºâ€œä¸èƒ½æ›´æ–°æœªæŒ‚è½½çš„æ ¹èŠ‚ç‚¹â€çš„é”™è¯¯ã€‚

---

## ç”¨æ³• {/*usage*/}

### æ¿€æ´»æœåŠ¡ç«¯æ¸²æŸ“çš„ HTML {/*hydrating-server-rendered-html*/}

å¦‚æœä½ çš„åº”ç”¨ç¨‹åºçš„ HTML æ˜¯ç”± [`react-dom/server`](/reference/react-dom/client/createRoot) ç”Ÿæˆçš„ï¼Œä½ éœ€è¦åœ¨å®¢æˆ·ç«¯ä¸Šè¿›è¡Œ **hydrate**ã€‚

```js [[1, 3, "document.getElementById('root')"], [2, 3, "<App />"]]
import { hydrateRoot } from 'react-dom/client';

hydrateRoot(document.getElementById('root'), <App />);
```

å¯¹äºä½ çš„åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œè¿™å°†æ¿€æ´»ä½ çš„æœåŠ¡ç«¯ HTML æ¥å¤è‹é‡Œé¢çš„ <CodeStep step={1}>æµè§ˆå™¨ DOM èŠ‚ç‚¹</CodeStep>å’Œ <CodeStep step={2}>React ç»„ä»¶</CodeStep>ã€‚é€šå¸¸ï¼Œä½ åªéœ€è¦åœ¨å¯åŠ¨æ—¶æ‰§è¡Œä¸€æ¬¡ã€‚å¦‚æœä½ ä½¿ç”¨æ¡†æ¶ï¼Œåˆ™å¯èƒ½ä¼šè‡ªåŠ¨åœ¨å¹•åæ‰§è¡Œæ­¤æ“ä½œã€‚

ä¸ºäº†è¿›è¡Œæ¿€æ´»ï¼ŒReact å°†æŠŠä½ çš„ç»„ä»¶é€»è¾‘è¿æ¥åˆ°æœåŠ¡å™¨ä¸Šç”Ÿæˆçš„åˆå§‹ HTML ä¸­ã€‚æ¿€æ´»å¯ä»¥å°†æ¥è‡ªæœåŠ¡å™¨çš„åˆå§‹ HTML å¿«ç…§è½¬æ¢ä¸ºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„å®Œå…¨å¯äº¤äº’åº”ç”¨ã€‚

<Sandpack>

```html public/index.html
<!--
  åœ¨ <div id="root">...</div> ä¸­çš„ HTML å†…å®¹
  ç”± react-dom/server ç”Ÿæˆ
-->
<div id="root"><h1>Hello, world!</h1><button>You clicked me <!-- -->0<!-- --> times</button></div>
```

```js src/index.js active
import './styles.css';
import { hydrateRoot } from 'react-dom/client';
import App from './App.js';

hydrateRoot(
  document.getElementById('root'),
  <App />
);
```

```js src/App.js
import { useState } from 'react';

export default function App() {
  return (
    <>
      <h1>Hello, world!</h1>
      <Counter />
    </>
  );
}

function Counter() {
  const [count, setCount] = useState(0);
  return (
    <button onClick={() => setCount(count + 1)}>
      You clicked me {count} times
    </button>
  );
}
```

</Sandpack>

ä½ ä¸éœ€è¦å†æ¬¡è°ƒç”¨ `hydrateRoot` æˆ–è€…åœ¨å…¶ä»–åœ°æ–¹è°ƒç”¨å®ƒã€‚ä»ç°åœ¨å¼€å§‹ï¼ŒReact å°†ç®¡ç†ä½ çš„åº”ç”¨ç¨‹åºçš„ DOMã€‚æƒ³è¦æ›´æ–° UI è¯·ä½¿ç”¨ [useState](/reference/react/useState) æ›¿ä»£ã€‚

<Pitfall>

ä¼ é€’ç»™ `hydrateRoot` çš„ React æ ‘å¿…é¡»ç”Ÿæˆä¸æœåŠ¡ç«¯ **ç›¸åŒçš„è¾“å‡º**ã€‚

è¿™å¯¹äºç”¨æˆ·ä½“éªŒéå¸¸é‡è¦ã€‚ç”¨æˆ·ä¼šåœ¨ä½ çš„ JavaScript ä»£ç åŠ è½½å‰èŠ±è´¹ä¸€äº›æ—¶é—´æ¥æŸ¥çœ‹æœåŠ¡ç«¯ç”Ÿæˆçš„ HTMLã€‚æœåŠ¡ç«¯æ¸²æŸ“é€šè¿‡æ˜¾ç¤ºåº”ç”¨è¾“å‡ºçš„ HTML å¿«ç…§æ¥äº§ç”Ÿäº†åº”ç”¨ç¨‹åºåŠ é€ŸåŠ è½½çš„é”™è§‰ã€‚çªç„¶å‡ºç°ä¸åŒçš„å†…å®¹ä¼šç ´åè¿™ç§é”™è§‰ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæœåŠ¡ç«¯æ¸²æŸ“è¾“å‡ºå¿…é¡»ä¸å®¢æˆ·ç«¯åˆå§‹æ¸²æŸ“è¾“å‡ºåŒ¹é…ã€‚

å¯¼è‡´æ¿€æ´»é”™è¯¯çš„æœ€å¸¸è§åŸå› åŒ…æ‹¬ï¼š

* æ ¹èŠ‚ç‚¹ React ç”Ÿæˆçš„ HTML å‘¨å›´å­˜åœ¨é¢å¤–çš„ç©ºç™½ç¬¦ï¼ˆå¦‚æ¢è¡Œç¬¦ï¼‰ã€‚
* åœ¨æ¸²æŸ“é€»è¾‘ä¸­ä½¿ç”¨ `typeof window !== 'undefined'` è¿™æ ·çš„åˆ¤æ–­ã€‚
* åœ¨æ¸²æŸ“é€»è¾‘ä¸­ä½¿ç”¨ä»…é™äºæµè§ˆå™¨ç«¯çš„ APIï¼Œä¾‹å¦‚ [`window.matchMedia`](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/matchMedia)ã€‚
* åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯æ¸²æŸ“ä¸åŒçš„æ•°æ®ã€‚

React å¯ä»¥ä»ä¸€äº›æ¿€æ´»é”™è¯¯ä¸­æ¢å¤ï¼Œä½† **ä½ å¿…é¡»åƒå¤„ç†å…¶ä»– bug ä¸€æ ·ä¿®å¤å®ƒä»¬**ã€‚åœ¨æœ€å¥½çš„æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºåŠ è½½å˜æ…¢ï¼›åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œäº‹ä»¶å¤„ç†ç¨‹åºå¯èƒ½ä¼šé™„åŠ åˆ°é”™è¯¯çš„å…ƒç´ ä¸Šã€‚

</Pitfall>

---

### æ¿€æ´»æ•´ä¸ªæ–‡æ¡£ {/*hydrating-an-entire-document*/}

å®Œå…¨ä½¿ç”¨ React æ„å»ºçš„åº”ç”¨ç¨‹åºå¯ä»¥å°†æ•´ä¸ªæ–‡æ¡£ä½œä¸º JSX æ¸²æŸ“ï¼ŒåŒ…æ‹¬ [`<html>`](https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/html) æ ‡ç­¾ï¼š

```js {3,13}
function App() {
  return (
    <html>
      <head>
        <meta charSet="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" href="/styles.css"></link>
        <title>My app</title>
      </head>
      <body>
        <Router />
      </body>
    </html>
  );
}
```

è¦å¯¹æ•´ä¸ªæ–‡æ¡£è¿›è¡Œæ¿€æ´»å¤„ç†ï¼Œå°†å…¨å±€çš„ [`document`](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/document) ä½œä¸º `hydrateRoot` çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’ï¼š

```js {4}
import { hydrateRoot } from 'react-dom/client';
import App from './App.js';

hydrateRoot(document, <App />);
```

---

### æŠ‘åˆ¶ä¸å¯é¿å…çš„æ¿€æ´»å¤„ç†ä¸åŒ¹é…é”™è¯¯ {/*suppressing-unavoidable-hydration-mismatch-errors*/}

å¦‚æœä¸€ä¸ªå•ç‹¬å…ƒç´ å±æ€§æˆ–æ–‡æœ¬å†…å®¹åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´æ˜¯ä¸å¯é¿å…åœ°ä¸åŒçš„ï¼ˆä¾‹å¦‚ï¼Œæ—¶é—´æˆ³ï¼‰ï¼Œåˆ™å¯ä»¥æŠ‘åˆ¶æ¿€æ´»å¤„ç†ä¸åŒ¹é…è­¦å‘Šã€‚

è¦æ¶ˆé™¤å¯¹å…ƒç´ çš„æ¿€æ´»å¤„ç†è­¦å‘Šï¼Œè¯·æ·»åŠ  `suppressHydrationWarning={true}`ï¼š

<Sandpack>

```html public/index.html
<!--
  åœ¨ <div id="root">...</div> ä¸­çš„ HTML å†…å®¹
  ç”± react-dom/server ç”Ÿæˆ
-->
<div id="root"><h1>Current Date: <!-- -->01/01/2020</h1></div>
```

```js src/index.js
import './styles.css';
import { hydrateRoot } from 'react-dom/client';
import App from './App.js';

hydrateRoot(document.getElementById('root'), <App />);
```

```js src/App.js active
export default function App() {
  return (
    <h1 suppressHydrationWarning={true}>
      Current Date: {new Date().toLocaleDateString()}
    </h1>
  );
}
```

</Sandpack>

æ­¤æ–¹æ³•ä»…é€‚ç”¨äºå½“å‰å±‚çº§ï¼Œå¹¶ä¸”æ—¨åœ¨ä½œä¸ºä¸€ç§è„±å›´æœºåˆ¶ã€‚ä¸è¦æ»¥ç”¨å®ƒã€‚React **ä¸ä¼š** å°è¯•ä¿®è¡¥ä¸åŒ¹é…çš„æ–‡æœ¬å†…å®¹ã€‚

---

### å¤„ç†ä¸åŒçš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å†…å®¹ {/*handling-different-client-and-server-content*/}

å¦‚æœä½ æœ‰æ„åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¸Šå‘ˆç°ä¸åŒçš„å†…å®¹ï¼Œåˆ™å¯ä»¥è¿›è¡Œä¸¤æ¬¡æ¸²æŸ“ã€‚åœ¨å®¢æˆ·ç«¯ä¸Šå‘ˆç°ä¸åŒå†…å®¹çš„ç»„ä»¶å¯ä»¥è¯»å–ç±»ä¼¼äº `isClient` çš„ [çŠ¶æ€å˜é‡](/reference/react/useState)ï¼Œä½ å¯ä»¥åœ¨ [Effect](/reference/react/useEffect) ä¸­å°†å…¶è®¾ç½®ä¸º `true`ï¼š

<Sandpack>

```html public/index.html
<!--
  åœ¨ <div id="root">...</div> ä¸­çš„ HTML å†…å®¹
  ç”± react-dom/server ç”Ÿæˆ
-->
<div id="root"><h1>Is Server</h1></div>
```

```js src/index.js
import './styles.css';
import { hydrateRoot } from 'react-dom/client';
import App from './App.js';

hydrateRoot(document.getElementById('root'), <App />);
```

```js src/App.js active
import { useState, useEffect } from "react";

export default function App() {
  const [isClient, setIsClient] = useState(false);

  useEffect(() => {
    setIsClient(true);
  }, []);

  return (
    <h1>
      {isClient ? 'Is Client' : 'Is Server'}
    </h1>
  );
}
```

</Sandpack>

è¿™æ ·ï¼Œåˆå§‹æ¸²æŸ“å°†å‘ˆç°ä¸æœåŠ¡å™¨ç›¸åŒçš„å†…å®¹ï¼Œé¿å…ä¸åŒ¹é…ï¼Œä½†æ˜¯åœ¨æ¿€æ´»ä¹‹åä¼šåŒæ­¥è¿›è¡Œé¢å¤–çš„æ¸²æŸ“ã€‚

<Pitfall>

è¿™ç§æ–¹æ³•ä½¿å¾—æ¿€æ´»å˜æ…¢ï¼Œå› ä¸ºä½ çš„ç»„ä»¶éœ€è¦æ¸²æŸ“ä¸¤æ¬¡ã€‚è¦æ³¨æ„åœ¨ç½‘ç»œè¿æ¥è¾ƒæ…¢çš„æƒ…å†µä¸‹ç”¨æˆ·çš„ä½“éªŒã€‚JavaScript ä»£ç çš„åŠ è½½æ—¶é—´å¯èƒ½ä¼šæ¯”åˆå§‹çš„ HTML æ¸²æŸ“æ…¢å¾ˆå¤šï¼Œå› æ­¤åœ¨æ¿€æ´»ä¹‹åç«‹å³å‘ˆç°ä¸åŒçš„ UI å¯¹ç”¨æˆ·æ¥è¯´å¯èƒ½ä¹Ÿä¼šæ„Ÿåˆ°ä¸é€‚ã€‚

</Pitfall>

---

### æ›´æ–°æ¿€æ´»æ ¹ç»„ä»¶ {/*updating-a-hydrated-root-component*/}

åœ¨æ ¹ç»„ä»¶æ¿€æ´»å®Œæˆä¹‹åï¼Œä½ å¯ä»¥è°ƒç”¨ [`root.render`](#root-render) æ¥æ›´æ–°æ ¹ React ç»„ä»¶ã€‚**ä¸  [`createRoot`](/reference/react-dom/client/createRoot) ä¸åŒçš„æ˜¯ï¼Œé€šå¸¸ä½ ä¸éœ€è¦è¿™æ ·åšï¼Œå› ä¸ºåˆå§‹å†…å®¹å·²ç»æ¸²æŸ“ä¸º HTML**ã€‚

å¦‚æœåœ¨æ¿€æ´»ä¹‹åæŸä¸ªæ—¶åˆ»è°ƒç”¨äº† `root.render`ï¼Œå¹¶ä¸”ç»„ä»¶æ ‘ç»“æ„ä¸ä¹‹å‰æ¸²æŸ“çš„ç›¸åŒ¹é…ï¼Œé‚£ä¹ˆ React å°† [ä¿ç•™é‡ç½® state](/learn/preserving-and-resetting-state)ã€‚è¯·æ³¨æ„ï¼Œä½ å¯ä»¥åœ¨è¾“å…¥æ¡†ä¸­è¾“å…¥æ–‡å­—ï¼Œè¿™æ„å‘³ç€åœ¨æ­¤ç¤ºä¾‹ä¸­æ¯ç§’é’Ÿé‡å¤è°ƒç”¨çš„ `render` ä¸ä¼šç ´åå·²æœ‰çš„ç»„ä»¶çŠ¶æ€ï¼š

<Sandpack>

```html public/index.html
<!--
  åœ¨ <div id="root">...</div> ä¸­çš„ HTML å†…å®¹
  ç”± react-dom/server ç”Ÿæˆ
-->
<div id="root"><h1>Hello, world! <!-- -->0</h1><input placeholder="Type something here"/></div>
```

```js src/index.js active
import { hydrateRoot } from 'react-dom/client';
import './styles.css';
import App from './App.js';

const root = hydrateRoot(
  document.getElementById('root'),
  <App counter={0} />
);

let i = 0;
setInterval(() => {
  root.render(<App counter={i} />);
  i++;
}, 1000);
```

```js src/App.js
export default function App({counter}) {
  return (
    <>
      <h1>Hello, world! {counter}</h1>
      <input placeholder="Type something here" />
    </>
  );
}
```

</Sandpack>

It is uncommon to call [`root.render`](#root-render) on a hydrated root. Usually, you'll [update state](/reference/react/useState) inside one of the components instead.

### Error logging in production {/*error-logging-in-production*/}

By default, React will log all errors to the console. To implement your own error reporting, you can provide the optional error handler root options `onUncaughtError`, `onCaughtError` and `onRecoverableError`:

```js [[1, 7, "onCaughtError"], [2, 7, "error", 1], [3, 7, "errorInfo"], [4, 11, "componentStack", 15]]
import { hydrateRoot } from "react-dom/client";
import App from "./App.js";
import { reportCaughtError } from "./reportError";

const container = document.getElementById("root");
const root = hydrateRoot(container, <App />, {
  onCaughtError: (error, errorInfo) => {
    if (error.message !== "Known error") {
      reportCaughtError({
        error,
        componentStack: errorInfo.componentStack,
      });
    }
  },
});
```

The <CodeStep step={1}>onCaughtError</CodeStep> option is a function called with two arguments:

1. The <CodeStep step={2}>error</CodeStep> that was thrown.
2. An <CodeStep step={3}>errorInfo</CodeStep> object that contains the <CodeStep step={4}>componentStack</CodeStep> of the error.

Together with `onUncaughtError` and `onRecoverableError`, you can implement your own error reporting system:

<Sandpack>

```js src/reportError.js
function reportError({ type, error, errorInfo }) {
  // The specific implementation is up to you.
  // `console.error()` is only used for demonstration purposes.
  console.error(type, error, "Component Stack: ");
  console.error("Component Stack: ", errorInfo.componentStack);
}

export function onCaughtErrorProd(error, errorInfo) {
  if (error.message !== "Known error") {
    reportError({ type: "Caught", error, errorInfo });
  }
}

export function onUncaughtErrorProd(error, errorInfo) {
  reportError({ type: "Uncaught", error, errorInfo });
}

export function onRecoverableErrorProd(error, errorInfo) {
  reportError({ type: "Recoverable", error, errorInfo });
}
```

```js src/index.js active
import { hydrateRoot } from "react-dom/client";
import App from "./App.js";
import {
  onCaughtErrorProd,
  onRecoverableErrorProd,
  onUncaughtErrorProd,
} from "./reportError";

const container = document.getElementById("root");
hydrateRoot(container, <App />, {
  // Keep in mind to remove these options in development to leverage
  // React's default handlers or implement your own overlay for development.
  // The handlers are only specfied unconditionally here for demonstration purposes.
  onCaughtError: onCaughtErrorProd,
  onRecoverableError: onRecoverableErrorProd,
  onUncaughtError: onUncaughtErrorProd,
});
```

```js src/App.js
import { Component, useState } from "react";

function Boom() {
  foo.bar = "baz";
}

class ErrorBoundary extends Component {
  state = { hasError: false };

  static getDerivedStateFromError(error) {
    return { hasError: true };
  }

  render() {
    if (this.state.hasError) {
      return <h1>Something went wrong.</h1>;
    }
    return this.props.children;
  }
}

export default function App() {
  const [triggerUncaughtError, settriggerUncaughtError] = useState(false);
  const [triggerCaughtError, setTriggerCaughtError] = useState(false);

  return (
    <>
      <button onClick={() => settriggerUncaughtError(true)}>
        Trigger uncaught error
      </button>
      {triggerUncaughtError && <Boom />}
      <button onClick={() => setTriggerCaughtError(true)}>
        Trigger caught error
      </button>
      {triggerCaughtError && (
        <ErrorBoundary>
          <Boom />
        </ErrorBoundary>
      )}
    </>
  );
}
```

```html public/index.html hidden
<!DOCTYPE html>
<html>
<head>
  <title>My app</title>
</head>
<body>
<!--
  Purposefully using HTML content that differs from the server-rendered content to trigger recoverable errors.
-->
<div id="root">Server content before hydration.</div>
</body>
</html>
```
</Sandpack>

## Troubleshooting {/*troubleshooting*/}


### I'm getting an error: "You passed a second argument to root.render" {/*im-getting-an-error-you-passed-a-second-argument-to-root-render*/}

A common mistake is to pass the options for `hydrateRoot` to `root.render(...)`:

<ConsoleBlock level="error">

Warning: You passed a second argument to root.render(...) but it only accepts one argument.

</ConsoleBlock>

To fix, pass the root options to `hydrateRoot(...)`, not `root.render(...)`:
```js {2,5}
// ğŸš© Wrong: root.render only takes one argument.
root.render(App, {onUncaughtError});

// âœ… Correct: pass options to createRoot.
const root = hydrateRoot(container, <App />, {onUncaughtError});
```
